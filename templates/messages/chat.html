{% extends "user/base.html" %}
{% load static %}

{% block extrastyle %}
  <link rel="stylesheet" type="text/css" href="{% static 'messages/css/chat.css' %}" />
{% endblock %}


{% block content %}
<script type="text/javascript" src="{% static 'messages/js/chat.js' %}"></script>
<script>
  function populateThread(threadId) {
    $('.thread').each(function() {
      $(this).hide();
    });

    id = "#thread-" + threadId;
    $(id).show();
  }
</script>


<div class="row" style="height:100%; padding: 10px;" id="chat-room">
  <!--left navbar-->
  <div class="col-md-2 well" id="inbox">    
    <!--chat menu dropdown-->
    <div class="btn-group btn-group-justified" id="btn-chat-menu">
      <div class="btn-group" id="btn-chat-menu">
	<button type="button" class="btn btn-success btn-large dropdown-toggle" id="chatmenu" data-toggle="dropdown" aria-expanded="false">
	  Menu <span class="caret"></span>
	</button>
	<ul class="dropdown-menu" role="menu">
	  <li><a href="#">Settings</a></li>
	  <li><a href="#">Advanced Match</a></li>
	  <li><a href="#">Adjust Interests</a></li>
	  <li><a href="#">Submit Feedback</a></li>
	  <li><a href="#">Refer a Friend</a></li>
	</ul>
      </div>
    </div>      
    <!--inbox-->
    <ul class="nav nav-pills nav-stacked">
    {% for thread in inbox_threads %}
      <li role="presentation"><a class="inbox-message" href="#" onclick="populateThread({{ thread.pk }})">{{ thread }}</a></li>
    {% endfor %}
    </ul>

    <div class="btn btn-danger btn-large" id="btn-match-me">Match Me!</div>
  </div>
  <!--current message-->
  <div class="col-md-10 well" id="message-box" >
    <div class="row" style="padding-right: 20px; padding-top: 5px;">
      <div class="dropdown">
	<button class="btn btn-success dropdown-toggle pull-right" type="button" id="plusmenu" data-toggle="dropdown" aria-expanded="false">+</button>
	<ul class="dropdown-menu pull-right" role="menu" aria-labelledby="plusmenu">
	  <li><a href="#">Add a Person</a></li>
	  <li><a href="#">Report Conversation</a></li>
	  <li><a href="#">Nudge Person</a></li>
	</ul>
      </div>
    </div>
    <!--previously sent/received messages-->
    <div id="message-content">
      {% for thread in inbox_threads %}
      <div id="thread-{{ thread.pk }}" class="thread">
        {% for message in thread.message_set.all %}
	<div class="row">
          {% if message.sender == user %}
	  <div class="btn btn-primary disabled pull-right">{{ message }}</div>
          {% else %}
          <div class="btn btn-default disabled">{{ message }}</div>
          {% endif %}
	</div>
	{% endfor %}
      </div>
      {% endfor %}
    </div>
    <form id="send-message-form">
      <div class="input-group" id="send-message-row">
	<input class="form-control" type="text" id="message-input-box">
	<span class="input-group-btn">
	  <input type="submit" id="btn-send-message" class="btn btn-success" value="Send Message!" />
	</span>
      </div>
    </form>
  </div>
</div>



{% endblock %}
